import{R as X,_ as z,e as H,a as J,b as D,c as b,f as x,M as $,g as M,h as K,i as W,j as Y,k as B,l as Z,m as ee,n as ae,o as le,p as te,q as se}from"./Navbar.vue_vue_type_script_setup_true_lang.262f34dc.js";import{d as ne,u as ue,r as u,i as oe,o as de,c as N,a,w as s,b as e,F as R,e as f,g as h,j as S,I as re,E as U,f as m,l as ie,Q as T}from"./index.13e0a12b.js";import{a as g}from"./axios.f2a602b3.js";const ce=m("div",{class:"p-3"},"Nothing to display. Add a few chapters.",-1),me={class:"my-4"},pe={class:"my-4"},ve={class:"my-4"},_e={class:"my-4"},fe={class:"my-4"},be=ne({__name:"Chapters",setup(he){const j=X;ue();const y=u([]),p=u(!1),o=u(""),d=u(""),r=u(""),i=u(""),c=u(""),v=u({edited:!1,value:-1}),_=u(""),L=oe(()=>!(o.value.trim()===""||d.value.trim()===""||r.value.trim()===""||i.value.trim()===""||c.value.trim()==="")),A=()=>{o.value="",d.value="",r.value="",i.value="",c.value="",v.value={edited:!1,value:-1}},E=async()=>{!L.value||(v.value.edited?O(v.value.value,o.value,d.value,i.value,c.value,r.value):q(o.value,d.value,i.value,c.value,r.value),A(),p.value=!1)},F=n=>{o.value=n.chapterNumber,d.value=n.chapterTitle,i.value=n.chapterImage,c.value=n.chapterImageDescription,r.value=n.chapterIntroduction,v.value={edited:!0,value:n._id},p.value=!0},C=()=>{g.get(`${_.value}chapters`).then(n=>y.value=n.data)},V=u(""),Q=()=>{const n=V.value;g.get(`${_.value}chapters`,{params:{search:n}}).then(t=>y.value=t.data)},q=(n,t,l,k,w)=>{const I={chapterNumber:n,chapterTitle:t,chapterImage:l,chapterImageDescription:k,chapterIntroduction:w};g.post(`${_.value}chapters`,I).then(()=>{C()})},G=n=>{g.delete(`${_.value}chapters/${n}`).then(()=>{C()})},O=(n,t,l,k,w,I)=>{const P={chapterNumber:t,chapterTitle:l,chapterImage:k,chapterImageDescription:w,chapterIntroduction:I};g.put(`${_.value}chapters/${n}`,P).then(()=>{C()})};return de(()=>{_.value="https://textbookai-backend.mdbgo.io:3000/",C()}),(n,t)=>(f(),N(R,null,[a(e(z),{class:"mt-5"},{default:s(()=>[a(J),a(e(D),{class:"g-2 g-lg-3 pt-5 pb-4"},{default:s(()=>[a(e(b),{class:"text-start"},{default:s(()=>[a(e(x),{color:"secondary",onClick:t[0]||(t[0]=l=>p.value=!0)},{default:s(()=>[h("Add Chapter")]),_:1})]),_:1}),a(e(b),{md:"4"},{default:s(()=>[a(e($),{inputGroup:"",formOutline:!1,wrapperClass:"mb-3",modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=l=>V.value=l),placeholder:"Search chapters, e.g. 'chapter 1', 'awakening', ...","aria-label":"Search"},{default:s(()=>[a(e(x),{color:"primary",onClick:Q},{default:s(()=>[a(e(M),{icon:"search"})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),y.value.length===0?(f(),S(e(D),{key:0,class:"gy-5"},{default:s(()=>[a(e(b),{col:"6",class:"p-3"},{default:s(()=>[ce]),_:1})]),_:1})):(f(),S(e(D),{key:1,class:"gy-5"},{default:s(()=>[(f(!0),N(R,null,re(y.value,l=>(f(),S(e(b),{md:"4",class:"d-flex justify-content-center align-items-center"},{default:s(()=>[a(e(ee),null,{default:s(()=>[ie((f(),N("a",null,[a(e(ae),{style:{width:"100%",height:"15rem","object-fit":"cover"},src:l.chapterImage,top:"",alt:l.chapterImageDescription,label:l.chapterImageDescription,caption:l.chapterImageDescription},null,8,["src","alt","label","caption"])])),[[e(j),{color:"light"}]]),a(e(le),null,{default:s(()=>[a(e(te),null,{default:s(()=>[h(" Chapter "+U(l.chapterNumber)+" ",1),a(e(T),{text:l.chapterTitle,"max-lines":2},null,8,["text"])]),_:2},1024),a(e(se),null,{default:s(()=>[a(e(T),{text:l.chapterIntroduction,"max-lines":3},null,8,["text"])]),_:2},1024),a(e(M),{class:"text-primary me-3",title:"edit",icon:"pen",style:{cursor:"pointer"},onClick:()=>F(l)},null,8,["onClick"]),a(e(M),{class:"text-danger",title:"delete",icon:"trash",style:{cursor:"pointer"},onClick:()=>G(l._id)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}))]),_:1}),a(e(H),{id:"addNewChapterModal",tabindex:"-1",labelledby:"addNewChapterModalLabel",modelValue:p.value,"onUpdate:modelValue":t[8]||(t[8]=l=>p.value=l)},{default:s(()=>[a(e(K),null,{default:s(()=>[a(e(W),{id:"exampleModalLabel"},{default:s(()=>[h(U(v.value.edited?"Edit chapter":"Add chapter"),1)]),_:1})]),_:1}),a(e(Y),null,{default:s(()=>[m("form",null,[m("div",me,[a(e($),{label:"chapter_number",type:"text",modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value=l),counter:"",maxlength:2},null,8,["modelValue"])]),m("div",pe,[a(e($),{label:"chapter_title",type:"text",modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=l=>d.value=l),counter:"",maxlength:255},null,8,["modelValue"])]),m("div",ve,[a(e($),{label:"chapter_image",type:"text",modelValue:i.value,"onUpdate:modelValue":t[4]||(t[4]=l=>i.value=l)},null,8,["modelValue"])]),m("div",_e,[a(e(B),{label:"chapter_image_description",type:"text",modelValue:c.value,"onUpdate:modelValue":t[5]||(t[5]=l=>c.value=l)},null,8,["modelValue"])]),m("div",fe,[a(e(B),{label:"chapter_introduction",type:"text",modelValue:r.value,"onUpdate:modelValue":t[6]||(t[6]=l=>r.value=l)},null,8,["modelValue"])])])]),_:1}),a(e(Z),null,{default:s(()=>[a(e(x),{color:"secondary",onClick:t[7]||(t[7]=l=>{A(),p.value=!1})},{default:s(()=>[h("Close")]),_:1}),a(e(x),{color:"primary",onClick:E,disabled:!L.value},{default:s(()=>[h(U(v.value.edited?"Save changes":"Add Chapter"),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["modelValue"])],64))}});export{be as default};
